{{ define "main" }}
{{/*
Unified list template for all section pages.
Uses static-window.html for consistent window chrome.
Each section maps to a specific content partial.
*/}}

{{/* Build section-specific data */}}
{{ $contentPartial := "" }}
{{ $contentData := dict }}

{{ if eq .Section "wins" }}
{{ $contentPartial = "apps/wins/list.html" }}
{{ $contentData = dict "id" "wins-page" "title" "Wins" }}

{{ else if eq .Section "contact" }}
{{ $contentPartial = "apps/contact/book.html" }}
{{ $contentData = dict "id" "contact-page" "title" "Contacts" }}

{{ else if eq .Section "schedule" }}
{{ $contentPartial = "apps/contact/schedule.html" }}
{{ $contentData = dict }}

{{ else if eq .Section "timeline" }}
{{ $contentPartial = "apps/timeline/calendar.html" }}
{{ $projectPages := where .Site.RegularPages "Section" "projects" }}
{{ $blogPages := where .Site.RegularPages "Section" "blogs" }}
{{ $allPages := .Pages | union $projectPages | union $blogPages }}
{{ $contentData = dict
"id" "timeline-page"
"title" "Timeline"
"pages" $allPages.ByDate.Reverse
"prefix" "timeline"
"standalone" true
}}

{{ else if eq .Section "projects" }}
{{ $contentPartial = "apps/projects/grid.html" }}
{{ $contentData = dict
"id" "projects-page"
"title" "Projects"
"pages" .Pages.ByDate.Reverse
"prefix" "project"
"standalone" true
}}

{{ else if eq .Section "blogs" }}
{{ $contentPartial = "apps/blog/list.html" }}
{{ $contentData = dict
"id" "blogs-page"
"title" "Blogs"
"pages" .Pages.ByDate.Reverse
"prefix" "post"
"standalone" true
}}

{{ end }}

{{/* Render the static window with the appropriate content */}}
{{ if $contentPartial }}
{{ partial "os/window/static.html" (dict
"title" .Title
"content" $contentPartial
"contentData" $contentData
) }}
{{ else }}
{{/* Fallback for sections with raw content but no child pages */}}
{{ $hasContent := gt (len .Content) 0 }}
{{ $hasPages := gt (len .Pages) 0 }}

{{ if and $hasContent (not $hasPages) }}
{{ partial "os/window/static.html" (dict
"title" .Title
"rawContent" .Content
"padding" "24px"
) }}
{{ else }}
{{/* Generic Finder-style list for undefined sections */}}
{{ partial "os/window/static.html" (dict
"title" .Title
"content" "apps/finder/list.html"
"contentData" (dict "pages" .Pages.ByDate.Reverse "section" .Section)
) }}
{{ end }}
{{ end }}

{{ end }}