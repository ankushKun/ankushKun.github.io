{{ define "main" }}
{{/*
Unified list template for all section pages.
Uses static-window.html for consistent window chrome.
Each section maps to a specific content partial.
*/}}

{{/* Build section-specific data */}}
{{ $contentPartial := "" }}
{{ $contentData := dict }}

{{ if eq .Section "wins" }}
{{ $contentPartial = "wins-list.html" }}
{{ $contentData = dict "id" "wins-page" "title" "Wins" }}

{{ else if eq .Section "contact" }}
{{ $contentPartial = "contact-book.html" }}
{{ $contentData = dict "id" "contact-page" "title" "Contacts" }}

{{ else if eq .Section "schedule" }}
{{ $contentPartial = "schedule-embed.html" }}
{{ $contentData = dict }}

{{ else if eq .Section "timeline" }}
{{ $contentPartial = "calendar-view.html" }}
{{ $projectPages := where .Site.RegularPages "Section" "projects" }}
{{ $allPages := .Pages | union $projectPages }}
{{ $contentData = dict
"id" "timeline-page"
"title" "Timeline"
"pages" $allPages.ByDate.Reverse
"prefix" "timeline"
"standalone" true
}}

{{ else if eq .Section "projects" }}
{{ $contentPartial = "projects-grid.html" }}
{{ $contentData = dict
"id" "projects-page"
"title" "Projects"
"pages" .Pages.ByDate.Reverse
"prefix" "project"
"standalone" true
}}

{{ else if eq .Section "blogs" }}
{{ $contentPartial = "blogs-list.html" }}
{{ $contentData = dict
"id" "blogs-page"
"title" "Blogs"
"pages" .Pages.ByDate.Reverse
"prefix" "post"
"standalone" true
}}

{{ end }}

{{/* Render the static window with the appropriate content */}}
{{ if $contentPartial }}
{{ partial "static-window.html" (dict
"title" .Title
"content" $contentPartial
"contentData" $contentData
) }}
{{ else }}
{{/* Fallback for sections with raw content but no child pages */}}
{{ $hasContent := gt (len .Content) 0 }}
{{ $hasPages := gt (len .Pages) 0 }}

{{ if and $hasContent (not $hasPages) }}
{{ partial "static-window.html" (dict
"title" .Title
"rawContent" .Content
"padding" "24px"
) }}
{{ else }}
{{/* Generic Finder-style list for undefined sections */}}
{{ partial "static-window.html" (dict
"title" .Title
"content" "finder-list.html"
"contentData" (dict "pages" .Pages.ByDate.Reverse "section" .Section)
) }}
{{ end }}
{{ end }}

{{ end }}