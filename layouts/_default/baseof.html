<!DOCTYPE html>
<html lang="{{ .Site.LanguageCode }}">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">

    {{ if .IsHome }}
    <!-- macOS Boot Screen Loader - Inline to prevent FOUC -->
    <style id="loader-styles">
        /* macOS Boot Screen Loader */
        #macos-boot-loader {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            z-index: 999999;
            background-color: #b3b3b3;
            transition: opacity 0.6s ease-out;
        }

        #macos-boot-loader.fade-out {
            opacity: 0;
            pointer-events: none;
        }

        /* Apple Logo - Centered */
        .boot-apple-logo {
            width: 100px;
            height: 120px;
            position: absolute;
            top: 47%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        .boot-apple-logo svg {
            width: 100%;
            height: 100%;
            fill: #555555;
        }

        /* Spinning Wheel - Offset below center */
        .boot-spinner {
            width: 28px;
            height: 28px;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            margin-top: 200px;
        }

        .boot-spinner-blade {
            position: absolute;
            left: 50%;
            top: 0;
            width: 2.5px;
            height: 8px;
            margin-left: -1.25px;
            border-radius: 2px;
            background-color: #555555;
            transform-origin: center 14px;
            animation: boot-spinner-fade 1s linear infinite;
        }

        /* Create 12 blades with different rotations and delays */
        .boot-spinner-blade:nth-child(1) {
            transform: rotate(0deg);
            animation-delay: -0.917s;
        }

        .boot-spinner-blade:nth-child(2) {
            transform: rotate(30deg);
            animation-delay: -0.833s;
        }

        .boot-spinner-blade:nth-child(3) {
            transform: rotate(60deg);
            animation-delay: -0.75s;
        }

        .boot-spinner-blade:nth-child(4) {
            transform: rotate(90deg);
            animation-delay: -0.667s;
        }

        .boot-spinner-blade:nth-child(5) {
            transform: rotate(120deg);
            animation-delay: -0.583s;
        }

        .boot-spinner-blade:nth-child(6) {
            transform: rotate(150deg);
            animation-delay: -0.5s;
        }

        .boot-spinner-blade:nth-child(7) {
            transform: rotate(180deg);
            animation-delay: -0.417s;
        }

        .boot-spinner-blade:nth-child(8) {
            transform: rotate(210deg);
            animation-delay: -0.333s;
        }

        .boot-spinner-blade:nth-child(9) {
            transform: rotate(240deg);
            animation-delay: -0.25s;
        }

        .boot-spinner-blade:nth-child(10) {
            transform: rotate(270deg);
            animation-delay: -0.167s;
        }

        .boot-spinner-blade:nth-child(11) {
            transform: rotate(300deg);
            animation-delay: -0.083s;
        }

        .boot-spinner-blade:nth-child(12) {
            transform: rotate(330deg);
            animation-delay: 0s;
        }

        @keyframes boot-spinner-fade {
            0% {
                opacity: 1;
            }

            100% {
                opacity: 0.15;
            }
        }
    </style>

    <script>
        // Track loading state immediately
        (function () {
            window.__bootLoaderReady = false;

            function hideLoader() {
                if (window.__bootLoaderReady) return;
                window.__bootLoaderReady = true;

                const loader = document.getElementById('macos-boot-loader');
                if (loader) {
                    loader.classList.add('fade-out');
                    setTimeout(() => {
                        loader.style.display = 'none';
                        // Clean up loader styles
                        const loaderStyles = document.getElementById('loader-styles');
                        if (loaderStyles) loaderStyles.remove();
                    }, 600);
                }
            }

            // Listen for document states
            document.addEventListener('readystatechange', function () {
                if (document.readyState === 'complete') {
                    // All resources loaded - hide after a brief moment
                    setTimeout(hideLoader, 100);
                }
            });

            // Fallback: window load event
            window.addEventListener('load', function () {
                setTimeout(hideLoader, 100);
            });

            // Safety timeout - never show loader for more than 8 seconds
            setTimeout(hideLoader, 8000);

            // Expose global function for manual trigger
            window.completeBootLoader = hideLoader;
        })();
    </script>
    {{ end }}

    <!-- SEO Meta Tags -->
    <title>{{ if .IsHome }}{{ .Site.Title }}{{ else }}{{ .Title }} | {{ .Site.Title }}{{ end }}</title>
    <meta name="description"
        content="{{ with .Description }}{{ . }}{{ else }}{{ with .Summary }}{{ . }}{{ else }}Ankush Singh - Software Engineer & Community Builder{{ end }}{{ end }}">
    <meta name="author" content="Ankush Singh">
    <meta name="keywords"
        content="Ankush Singh, Software Engineer, Developer Tools, Arweave, AO, Web3, Blockchain, BetterIDEa, Forward Research">
    <link rel="canonical" href="{{ .Permalink }}">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="{{ if .IsPage }}article{{ else }}website{{ end }}">
    <meta property="og:url" content="{{ .Permalink }}">
    <meta property="og:title" content="{{ if .IsHome }}{{ .Site.Title }}{{ else }}{{ .Title }}{{ end }}">
    <meta property="og:description"
        content="{{ with .Description }}{{ . }}{{ else }}{{ with .Summary }}{{ . }}{{ else }}Ankush Singh - Software Engineer & Community Builder{{ end }}{{ end }}">
    <meta property="og:image" content="{{ .Site.BaseURL }}og-image.jpg">
    <meta property="og:image:width" content="1560">
    <meta property="og:image:height" content="816">
    <meta property="og:image:alt" content="Ankush Kun - Software Engineer & Community Builder">
    <meta property="og:site_name" content="{{ .Site.Title }}">

    <!-- Twitter Cards -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@ankushKun_">
    <meta name="twitter:creator" content="@ankushKun_">
    <meta name="twitter:title" content="{{ if .IsHome }}{{ .Site.Title }}{{ else }}{{ .Title }}{{ end }}">
    <meta name="twitter:description"
        content="{{ with .Description }}{{ . }}{{ else }}{{ with .Summary }}{{ . }}{{ else }}Ankush Singh - Software Engineer & Community Builder{{ end }}{{ end }}">
    <meta name="twitter:image" content="{{ .Site.BaseURL }}og-image.jpg">
    <meta name="twitter:image:alt" content="Ankush Kun - Software Engineer & Community Builder">

    <!-- Mobile App & Theme Color -->
    <meta name="theme-color" content="#f0f0f0">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <!-- Styles -->
    {{ $mainStyle := resources.Get "css/main.css" }}
    <link rel="stylesheet" href="{{ $mainStyle.Permalink }}">
    {{ $style := resources.Get "css/mavericks.css" }}
    <link rel="stylesheet" href="{{ $style.Permalink }}">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

    <link rel="icon" href="/pfp.png" type="image/x-icon">

    <!-- PostHog Analytics -->
    {{ partial "posthog.html" . }}

    <!-- Preload Wallpaper for Performance -->
    <link rel="preload" as="image" href="/wallpaper.webp">
</head>

<body>
    {{ if .IsHome }}
    <!-- macOS Boot Screen Loader -->
    <div id="macos-boot-loader">
        <!-- Apple Logo -->
        <div class="boot-apple-logo">
            <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path
                    d="M18.71 19.5c-.83 1.24-1.71 2.45-3.05 2.47-1.34.03-1.77-.79-3.29-.79-1.53 0-2 .77-3.27.82-1.31.05-2.3-1.32-3.14-2.53C4.25 17 2.94 12.45 4.7 9.39c.87-1.52 2.43-2.48 4.12-2.51 1.28-.02 2.5.87 3.29.87.78 0 2.26-1.07 3.81-.91.65.03 2.47.26 3.64 1.98-.09.06-2.17 1.28-2.15 3.81.03 3.02 2.65 4.03 2.68 4.04-.03.07-.42 1.44-1.38 2.83M13 3.5c.73-.83 1.94-1.46 2.94-1.5.13 1.17-.34 2.35-1.04 3.19-.69.85-1.83 1.51-2.95 1.42-.15-1.15.41-2.35 1.05-3.11z" />
            </svg>
        </div>
        <!-- Spinning Wheel -->
        <div class="boot-spinner">
            <div class="boot-spinner-blade"></div>
            <div class="boot-spinner-blade"></div>
            <div class="boot-spinner-blade"></div>
            <div class="boot-spinner-blade"></div>
            <div class="boot-spinner-blade"></div>
            <div class="boot-spinner-blade"></div>
            <div class="boot-spinner-blade"></div>
            <div class="boot-spinner-blade"></div>
            <div class="boot-spinner-blade"></div>
            <div class="boot-spinner-blade"></div>
            <div class="boot-spinner-blade"></div>
            <div class="boot-spinner-blade"></div>
        </div>
    </div>
    {{ end }}

    <!-- macOS Menu Bar -->
    <div class="menubar">
        <div class="menubar-left">
            <div class="apple-menu" role="button" tabindex="0" aria-label="Apple Menu" aria-haspopup="true"
                aria-expanded="false" onclick="toggleAppleMenu(event)"
                onkeydown="if(event.key === 'Enter' || event.key === ' ') { toggleAppleMenu(event); event.preventDefault(); }">
                <svg viewBox="0 0 24 24" width="16" height="16" fill="white" aria-hidden="true">
                    <path
                        d="M18.71 19.5c-.83 1.24-1.71 2.45-3.05 2.47-1.34.03-1.77-.79-3.29-.79-1.53 0-2 .77-3.27.82-1.31.05-2.3-1.32-3.14-2.53C4.25 17 2.94 12.45 4.7 9.39c.87-1.52 2.43-2.48 4.12-2.51 1.28-.02 2.5.87 3.29.87.78 0 2.26-1.07 3.81-.91.65.03 2.47.26 3.64 1.98-.09.06-2.17 1.28-2.15 3.81.03 3.02 2.65 4.03 2.68 4.04-.03.07-.42 1.44-1.38 2.83M13 3.5c.73-.83 1.94-1.46 2.94-1.5.13 1.17-.34 2.35-1.04 3.19-.69.85-1.83 1.51-2.95 1.42-.15-1.15.41-2.35 1.05-3.11z" />
                </svg>
                <div class="apple-dropdown" id="apple-dropdown" role="menu">
                    <div class="dropdown-item" role="menuitem" tabindex="0"
                        onclick="openAboutThisMac(); closeDropdowns()">About This Site</div>
                    <div class="dropdown-divider" aria-hidden="true"></div>
                    <div class="dropdown-item" role="menuitem" tabindex="0"
                        onclick="closeAllWindows(); closeDropdowns()">Close All Windows</div>
                    <div class="dropdown-item" role="menuitem" tabindex="0" onclick="tileWindows(); closeDropdowns()">
                        Tile Windows</div>
                    <div class="dropdown-divider" aria-hidden="true"></div>
                    <div class="dropdown-item" role="menuitem" tabindex="0" onclick="location.reload()">Refresh</div>
                </div>
            </div>
            <div class="menu-item active finder-menu" role="button" tabindex="0" aria-haspopup="true"
                onclick="toggleFinderMenu(event)"
                onkeydown="if(event.key === 'Enter' || event.key === ' ') { toggleFinderMenu(event); event.preventDefault(); }">
                <span id="active-app-name">Finder</span>
                <div class="finder-dropdown" id="finder-dropdown" role="menu">
                    <div class="dropdown-label">Windows</div>
                    <div id="finder-windows-list">
                        <div class="dropdown-item empty">No windows open</div>
                    </div>
                </div>
            </div>
        </div>
        <div class="menubar-right">
            <div class="menubar-icon" role="button" tabindex="0" aria-label="Spotlight Search"
                onclick="toggleSpotlightFromMenu()"
                onkeydown="if(event.key === 'Enter' || event.key === ' ') { toggleSpotlightFromMenu(); event.preventDefault(); }"
                title="Search (âŒ˜+Space)">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5"
                    stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                    <circle cx="11" cy="11" r="8"></circle>
                    <path d="m21 21-4.3-4.3"></path>
                </svg>
            </div>
            <span class="menu-status" id="clock" aria-label="Clock"></span>
        </div>
    </div>

    <!-- Desktop -->
    <div class="desktop" id="desktop">
        {{ block "main" . }}{{ end }}
    </div>

    <!-- Window Container -->
    <div class="windows-container" id="windows-container"></div>

    {{ $js := resources.Get "js/mavericks.js" | resources.Minify | resources.Fingerprint }}
    <script src="{{ $js.Permalink }}"></script>
</body>

</html>